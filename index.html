<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Schedule - Infinite Campus</title>
<link rel="icon" type="image/png" href="infinite-campus-icon.png">
<style>
body { margin:0; overflow:hidden; background:black; font-family:sans-serif; }
canvas { display:block; }
#ui { position:absolute; top:0; left:0; width:100%; height:100%; pointer-events:none; color:#0ff; font-size:24px; }
#startScreen {
    position:absolute; top:50%; left:50%; transform:translate(-50%,-50%);
    width:400px; padding:40px; background:rgba(0,0,0,0.9);
    display:flex; flex-direction:column; justify-content:center; align-items:center;
    pointer-events:all; font-size:30px; color:#0ff; text-shadow:0 0 20px #0ff;
    border:3px solid #0ff; border-radius:20px; box-sizing:border-box;
}
button { font-size:32px; padding:15px 40px; cursor:pointer; margin-top:30px; color:#0ff; background:black; border:3px solid #0ff; border-radius:12px; transition:0.3s; }
button:hover { color:black; background:#0ff; }
h1 { font-size:60px; margin-bottom:20px; text-shadow: 0 0 20px #0ff, 0 0 40px #0ff, 0 0 60px #0ff; animation: glow 1.5s infinite alternate; }
@keyframes glow { 0% { text-shadow:0 0 10px #0ff,0 0 20px #0ff;} 100% {text-shadow:0 0 40px #0ff,0 0 80px #0ff;} }

#settingsBtn {
    position:absolute; top:10px; right:10px; width:40px; height:40px; cursor:pointer; pointer-events:all;
}
.gear { width:100%; height:100%; border-radius:50%; border:3px solid #0ff; position:relative; box-sizing:border-box; }
.gear::before, .gear::after {
    content:""; position:absolute; width:6px; height:20px; background:#0ff; top:10px; left:50%; transform:translateX(-50%); 
}
.gear::after { transform:translateX(-50%) rotate(90deg); }

#settingsPanel {
    position:absolute; top:50%; left:50%; transform:translate(-50%,-50%);
    width:500px; padding:20px; background:rgba(0,0,0,0.95); border:3px solid #0ff; border-radius:20px;
    display:none; flex-direction:column; color:#0ff; font-size:20px; pointer-events:all;
}
select, input[type="checkbox"] { margin-top:10px; font-size:18px; }
</style>
</head>
<body>
<canvas id="gameCanvas"></canvas>
<div id="ui">
  <div id="startScreen">
    <h1>BRIDD JUMP</h1>
    <div id="bestScore">Best Score: 0</div>
    <div id="lastScore">Last Score: 0</div>
    <button id="startBtn">START</button>
    <div id="settingsBtn"><div class="gear"></div></div>
  </div>

  <div id="settingsPanel">
    <label>Quality:
      <select id="qualitySelect">
        <option value="lowest">Lowest</option>
        <option value="low">Low</option>
        <option value="medium">Medium</option>
        <option value="medium+">Medium+</option>
        <option value="high">High</option>
        <option value="high+">High+</option>
        <option value="extreme">Extreme</option>
        <option value="extreme+">Extreme+</option>
        <option value="ultra">Ultra</option>
        <option value="ultra+++">Ultra+++</option>
      </select>
    </label>
    <label>Max FPS:
      <select id="fpsSelect">
        <option value="5">5</option><option value="10">10</option><option value="15">15</option>
        <option value="20">20</option><option value="25">25</option><option value="30">30</option>
        <option value="35">35</option><option value="40">40</option><option value="45">45</option>
        <option value="50">50</option><option value="60">60</option><option value="70">70</option>
        <option value="80">80</option><option value="90">90</option><option value="100">100</option>
        <option value="120">120</option><option value="140">140</option><option value="160">160</option>
        <option value="180">180</option><option value="200">200</option><option value="unlimited">Unlimited</option>
      </select>
    </label>
    <label>Show FPS:
      <input type="checkbox" id="showFpsCheckbox" checked>
    </label>
    <button id="closeSettingsBtn" style="margin-top:20px;">Close Settings</button>
  </div>
</div>

<script>
const canvas=document.getElementById("gameCanvas");
const ctx=canvas.getContext("2d");
canvas.width=window.innerWidth;
canvas.height=window.innerHeight;

const BLOCK_SIZE=50;
const JUMP_SPEED=-15;
const GRAVITY=0.7;

let score=0, bestScore=localStorage.getItem("bestScore")?parseInt(localStorage.getItem("bestScore")):0;
let lastScore=localStorage.getItem("lastScore")?parseInt(localStorage.getItem("lastScore")):0;
let lastTime=0, gameStarted=false, animationFrameId;
let crashPieces=[], particles=[], gems=[], trails=[], lines=[];

let player={x:100,y:0,width:50,height:50,color:"#0ff",vy:0,speed:8,hitboxScale:0.6,jumpsLeft:2,onGround:false,visible:true,horizMultiplier:1,vertMultiplier:1};
let platforms=[], spikes=[], lastPlatformX=0, lastPlatformY=0;
let cheats={float:false, invincible:false, infiniteJump:false};
let vanish=false, vanishY=0, addScoreEnabled=true;

let globalTime=0, cameraX=0, cameraY=0;

let maxFPS = 60, showFPS = true, lastFrameTime=0;
let quality = "ultra+++"; // default

// --- Input control ---
let canClick = true;
window.addEventListener("keydown", e=>{
    if(["KeyW","ArrowUp","Space"].includes(e.code)) jump();
});
window.addEventListener("mousedown", ()=>{ if(canClick || cheats.infiniteJump) jump(); canClick=false; });
window.addEventListener("mouseup", ()=>canClick=true);
window.addEventListener("touchstart", ()=>{ if(canClick || cheats.infiniteJump) jump(); canClick=false; });
window.addEventListener("touchend", ()=>canClick=true);

function jump(){
    if(!player.visible) return;
    if(cheats.infiniteJump || player.jumpsLeft>0){
        player.vy=JUMP_SPEED;
        if(["medium+","high","high+","extreme","extreme+","ultra","ultra+++"].includes(quality)){
            spawnParticles(player.x+player.width/2,player.y+player.height,player.jumpsLeft===2?"jump":"double");
        }
        if(!cheats.infiniteJump) player.jumpsLeft--;
    }
}

function resetGame(){
    cancelAnimationFrame(animationFrameId);
    lastScore=Math.floor(score);
    localStorage.setItem("lastScore",lastScore);
    score=0; globalTime=0; colorIndex=0; cameraX=0; cameraY=0;
    player.x=100; player.y=canvas.height/2-player.height; player.vy=0; player.jumpsLeft=2;
    player.onGround=false; player.visible=true; player.horizMultiplier=1; player.vertMultiplier=1;
    platforms=[]; spikes=[]; crashPieces=[]; particles=[]; gems=[]; trails=[]; lines=[];
    platformColor={r:255,g:0,b:0};
    platforms.push({x:0,y:player.y+player.height,width:BLOCK_SIZE*10,height:BLOCK_SIZE,color:{...platformColor},passed:false});
    lastPlatformX=0; lastPlatformY=player.y+player.height;
    lastTime=performance.now();
    hideStartScreen();
    gameStarted=true;
    animationFrameId=requestAnimationFrame(update);
}

function showStartScreen(){
    document.getElementById("bestScore").innerText="Best Score: "+bestScore;
    document.getElementById("lastScore").innerText="Last Score: "+lastScore;
    document.getElementById("startScreen").style.display="flex";
}
function hideStartScreen(){ document.getElementById("startScreen").style.display="none"; }

// --- Settings button ---
document.getElementById("settingsBtn").addEventListener("click", ()=>{document.getElementById("settingsPanel").style.display="flex";});
document.getElementById("closeSettingsBtn").addEventListener("click", ()=>{document.getElementById("settingsPanel").style.display="none";});
document.getElementById("qualitySelect").addEventListener("change", e=>{quality=e.target.value;});
document.getElementById("fpsSelect").addEventListener("change", e=>{
    maxFPS=e.target.value==="unlimited"?Infinity:parseInt(e.target.value);
});
document.getElementById("showFpsCheckbox").addEventListener("change", e=>{showFPS=e.target.checked;});

// --- Start button ---
document.getElementById("startBtn").addEventListener("click", resetGame);

// --- Horizontal line fix ---
// Lines always visible and move faster than map
function addLines(){
    while(lines.length<canvas.height/5){
        lines.push({x:Math.random()*canvas.width,y:Math.random()*canvas.height,width:50});
    }
}

// --- Particle/Trail spawn ---
function spawnParticles(x,y,type){if(true)for(let i=0;i<15;i++)particles.push({x,y,vx:(Math.random()-0.5)*5,vy:(Math.random()-1.5)*5,life:Math.random()*30+20,color:type==="jump"?"#0ff":type==="double"?"#ff0":"#fff"});}

// --- Game loop ---
function update(time){
    if(maxFPS!==Infinity && time-lastFrameTime<1000/maxFPS){animationFrameId=requestAnimationFrame(update);return;} 
    lastFrameTime=time;
    let delta=(time-lastTime)/1000; lastTime=time; globalTime+=delta;
    
    if(gameStarted && player.visible){
        if(addScoreEnabled) score+=delta*10;
        player.speed+=0.002;
        player.y+=player.vy*player.vertMultiplier;
        if(cheats.float && player.vy>0) player.vy*=0.5;
        player.vy+=GRAVITY*player.vertMultiplier;
        player.x+=player.speed*player.horizMultiplier;

        // Trails
        if(["ultra+++"].includes(quality)) trails.push({x:player.x,y:player.y,width:player.width,height:player.height,color:player.color,life:40});

        player.onGround=false;
        for(let plat of platforms){
            if(player.x+player.width>plat.x && player.x<plat.x+plat.width &&
               player.y+player.height>plat.y && player.y+player.height<plat.y+plat.height+player.vy){
                if(player.vy>=0){ player.y=plat.y-player.height; player.vy=0; player.onGround=true; player.jumpsLeft=2; }
            }
        }

        if(player.y>canvas.height) player.visible=false;

        let lastPlatform = platforms[platforms.length-1];
        if(lastPlatform.x<player.x+canvas.width) generateBlockPlatform(lastPlatform.x,lastPlatform.y);
    }

    const targetCamX=player.x-150;
    const targetCamY=vanish?vanishY:player.y - canvas.height/2 + player.height*1.5;
    cameraX = cameraX*0.9 + targetCamX*0.1;
    cameraY = cameraY*0.9 + targetCamY*0.1;

    ctx.clearRect(0,0,canvas.width,canvas.height);

    // Trails
    for(let i=trails.length-1;i>=0;i--){let t=trails[i];ctx.globalAlpha=t.life/40; ctx.fillStyle=t.color; ctx.fillRect(t.x-cameraX,t.y-cameraY,t.width,t.height); t.life--; if(t.life<=0) trails.splice(i,1);}
    ctx.globalAlpha=1;

    // Horizontal lines
    addLines();
    for(let l of lines){l.x-=player.speed*1.5; ctx.strokeStyle="rgba(255,255,255,0.3)"; ctx.lineWidth=2; ctx.beginPath(); ctx.moveTo(l.x,l.y); ctx.lineTo(l.x+50,l.y); ctx.stroke();}
    lines=lines.filter(l=>l.x+50>0);

    // Show score and FPS
    ctx.fillStyle="#fff"; ctx.font="30px sans-serif"; ctx.fillText("Score: "+Math.floor(score),20,40); 
    ctx.fillText("Best: "+bestScore,20,80); ctx.fillText("Last: "+lastScore,20,120);
    if(showFPS) ctx.fillText("FPS: "+Math.floor(1000/delta),20,160);

    animationFrameId=requestAnimationFrame(update);
}

// --- Generate platform ---
function generateBlockPlatform(lastX,lastY){
    let blockCount=Math.floor(Math.random()*5+1);
    let gap=Math.floor(Math.random()*5+3)*BLOCK_SIZE;
    let x=lastX+gap; let y=lastY+(Math.floor(Math.random()*3)-1)*BLOCK_SIZE;
    y=Math.max(BLOCK_SIZE, Math.min(canvas.height-3*BLOCK_SIZE, y));
    for(let i=0;i<blockCount;i++) platforms.push({x:x+i*BLOCK_SIZE,y,width:BLOCK_SIZE,height:BLOCK_SIZE,color:{r:255,g:0,b:0},passed:false});
    return {x:x+blockCount*BLOCK_SIZE,y};
}

showStartScreen();
</script>
</body>
</html>
