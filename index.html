<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Bridd Jump</title>
<style>
  body { margin: 0; background: black; overflow: hidden; }
  canvas { display: block; margin: auto; background: #000; }
  #menu {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    color: white;
    font-family: sans-serif;
    text-align: center;
  }
  #menu button {
    font-size: 24px;
    padding: 10px 20px;
    margin-top: 20px;
    cursor: pointer;
  }
</style>
</head>
<body>
<div id="menu">
  <h1>Bridd Jump</h1>
  <button id="startBtn">START</button>
  <p id="bestScore">Best: 0</p>
</div>
<canvas id="gameCanvas"></canvas>
<script>
const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");
canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

// Game variables
let gameRunning = false;
let player, platforms, strikes, gems, ground, score, bestScore = 0;
let scrollX, speed, baseSpeed;
let deathRowFlash = null; // stores Y of row to flash
let flashTimer = 0;

// Player setup
function createPlayer() {
  return {
    x: 100,
    y: canvas.height - 200,
    w: 30,
    h: 40,
    dx: 0,
    dy: 0,
    onGround: false,
    jumps: 0,
    alive: true
  };
}

// Reset game
function initGame() {
  player = createPlayer();
  platforms = [];
  strikes = [];
  gems = [];
  ground = [{ x: 0, y: canvas.height - 50, w: 99999, h: 50 }];
  score = 0;
  baseSpeed = 4;
  speed = baseSpeed;
  scrollX = 0;
  deathRowFlash = null;
  flashTimer = 0;
}

// Draw death row flash
function drawDeathRow() {
  if (deathRowFlash !== null && flashTimer > 0) {
    ctx.strokeStyle = "white";
    ctx.lineWidth = 4;
    ctx.beginPath();
    ctx.moveTo(0, deathRowFlash);
    ctx.lineTo(canvas.width, deathRowFlash);
    ctx.stroke();
    flashTimer--;
    if (flashTimer <= 0) deathRowFlash = null;
  }
}

// Handle death
function handleDeath() {
  player.alive = false;
  deathRowFlash = Math.floor(player.y + player.h);
  flashTimer = 60; // show white line for ~1 sec
  setTimeout(() => {
    document.getElementById("menu").style.display = "block";
    if (score > bestScore) bestScore = score;
    document.getElementById("bestScore").innerText = "Best: " + bestScore;
    gameRunning = false;
  }, 1500);
}

// Update
function update() {
  if (!gameRunning) return;
  ctx.clearRect(0, 0, canvas.width, canvas.height);

  // Gravity
  player.dy += 0.5;
  player.y += player.dy;

  // Horizontal scroll
  scrollX += speed;

  // Ground collision
  if (player.y + player.h > canvas.height - 50) {
    player.y = canvas.height - 50 - player.h;
    player.dy = 0;
    player.onGround = true;
    player.jumps = 0;
  } else {
    player.onGround = false;
  }

  // Draw ground
  ctx.fillStyle = "#222";
  ground.forEach(g => ctx.fillRect(g.x - scrollX, g.y, g.w, g.h));

  // Draw player
  if (player.alive) {
    ctx.fillStyle = "cyan";
    ctx.fillRect(player.x, player.y, player.w, player.h);
  }

  // Death row flash
  drawDeathRow();

  requestAnimationFrame(update);
}

// Jump
function jump() {
  if (!player.alive) return;
  if (player.onGround || player.jumps < 1) {
    player.dy = -10;
    player.jumps++;
  }
}

// Controls
document.addEventListener("keydown", e => {
  if (e.code === "Space" || e.code === "ArrowUp") jump();
});
document.addEventListener("click", jump);

// Start button
document.getElementById("startBtn").addEventListener("click", () => {
  document.getElementById("menu").style.display = "none";
  initGame();
  gameRunning = true;
  update();
});
</script>
</body>
</html>
