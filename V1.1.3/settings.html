<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Settings | BRIDD JUMP</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
  <style>
    body {
      margin: 0;
      padding: 0;
      background: black;
      color: #0ff;
      font-family: 'Press Start 2P', cursive;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
    }
    .container {
      background: rgba(0,0,0,0.9);
      border: 3px solid #0ff;
      border-radius: 20px;
      padding: 30px;
      width: 640px;
      max-width: 95%;
      text-align: center;
      max-height: 90vh;
      overflow-y: auto;
    }
    h1 {
      font-size: 24px;
      margin-bottom: 20px;
      text-shadow: 0 0 10px #0ff, 0 0 20px #0ff;
    }
    label {
      display: block;
      margin: 15px 0 5px;
      font-size: 12px;
    }
    select, input[type=range], input[type=checkbox] {
      margin-bottom: 10px;
      background: black;
      color: #0ff;
      border: 2px solid #0ff;
      font-family: 'Press Start 2P', cursive;
      font-size: 12px;
      padding: 5px;
    }
    select, input[type=range] {
      width: 100%;
    }
    .range-value {
      font-size: 10px;
      margin-top: -5px;
      margin-bottom: 10px;
      color: #fff;
    }
    button {
      margin: 15px;
      padding: 12px 30px;
      font-size: 12px;
      cursor: pointer;
      color: #0ff;
      background: black;
      border: 3px solid #0ff;
      border-radius: 10px;
      font-family: 'Press Start 2P', cursive;
      transition: 0.3s;
    }
    button:hover {
      background: #0ff;
      color: black;
    }
    #advancedSettings, #effectsSettings, #motionEffects, #visualEnhancement {
      display: none;
      margin-top: 10px;
      border-top: 1px solid #0ff;
      padding-top: 10px;
    }
    #toggleAdvanced, #toggleEffects, #toggleMotion, #toggleVisual {
      font-size: 12px;
      background: transparent;
      border: 2px solid #0ff;
      padding: 8px 12px;
      cursor: pointer;
      margin-bottom: 10px;
    }
    #toggleAdvanced:hover, #toggleEffects:hover, #toggleMotion:hover, #toggleVisual:hover {
      background: #0ff;
      color: black;
    }
    .checkbox-container {
      display: flex;
      align-items: center;
      justify-content: center;
      margin: 10px 0;
    }
    .checkbox-container label {
      margin: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
      cursor: pointer;
      font-size: 10px;
    }
    .checkbox-container input[type="checkbox"] {
      width: 20px;
      height: 20px;
      margin: 0;
      cursor: pointer;
    }
    .settings-section {
      margin: 20px 0;
      border: 1px dashed #0ff;
      padding: 10px;
      border-radius: 10px;
    }
    .section-title {
      font-size: 14px;
      margin-bottom: 15px;
      color: #0ff;
      text-decoration: underline;
    }
    .preset-info {
      font-size: 9px;
      color: #888;
      margin-top: -10px;
      margin-bottom: 15px;
    }
    .warning {
      color: #ff0000;
      font-size: 10px;
      margin: 5px 0;
      text-shadow: 0 0 5px #ff0000;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>SETTINGS</h1>
    
    <div class="preset-info">Warning: Ultra++ and Highest presets may cause significant lag</div>

    <label for="fps">Max FPS:</label>
    <select id="fps">
      <option value="0">Unlimited</option>
      <option value="5">5</option>
      <option value="10">10</option>
      <option value="15">15</option>
      <option value="20">20</option>
      <option value="25">25</option>
      <option value="30">30</option>
      <option value="35">35</option>
      <option value="40">40</option>
      <option value="45">45</option>
      <option value="50">50</option>
      <option value="60">60</option>
      <option value="70">70</option>
      <option value="80">80</option>
      <option value="90">90</option>
      <option value="100">100</option>
      <option value="110">110</option>
      <option value="120">120</option>
      <option value="130">130</option>
      <option value="140">140</option>
      <option value="150">150</option>
      <option value="160">160</option>
      <option value="180">180</option>
      <option value="200">200</option>
      <option value="250">250</option>
      <option value="300">300</option>
    </select>

    <label for="quality">Quality Preset:</label>
    <select id="quality">
      <option>Potato</option>
      <option>Low</option>
      <option>Medium</option>
      <option>Medium+</option>
      <option>High</option>
      <option>High+</option>
      <option>Extreme</option>
      <option selected>Extreme+</option>
      <option>Ultra</option>
      <option>Ultra+</option>
      <option>Ultra++</option>
      <option>Highest</option>
    </select>

    <!-- Visual Effects Settings -->
    <button id="toggleVisual">Visual Effects Settings ▼</button>

    <div id="visualSettings">
      <div class="settings-section">
        <div class="section-title">Visual Effects</div>

        <label>Jump Effects</label>
        <input type="range" id="jumpEffect" min="0" max="200" value="100">
        <div class="range-value" id="jumpEffectVal">100%</div>

        <label>Walk Effects</label>
        <input type="range" id="walkEffect" min="0" max="200" value="100">
        <div class="range-value" id="walkEffectVal">100%</div>

        <label>Horizontal Line Effects</label>
        <input type="range" id="horizontalLines" min="0" max="200" value="100">
        <div class="range-value" id="horizontalLinesVal">100%</div>

        <label>Trail Effects</label>
        <input type="range" id="trail" min="0" max="200" value="100">
        <div class="range-value" id="trailVal">100%</div>

        <label>Glow Intensity</label>
        <input type="range" id="glow" min="0" max="200" value="100">
        <div class="range-value" id="glowVal">100%</div>

        <label>Background Parallax Layers</label>
        <input type="range" id="parallaxLayers" min="0" max="200" value="100">
        <div class="range-value" id="parallaxLayersVal">100%</div>

        <label>Velocity Streaks</label>
        <input type="range" id="velocityStreaks" min="0" max="200" value="100">
        <div class="range-value" id="velocityStreaksVal">100%</div>

        <label>Wind Particles</label>
        <input type="range" id="windParticles" min="0" max="200" value="100">
        <div class="range-value" id="windParticlesVal">100%</div>

        <label>Speed Lines</label>
        <input type="range" id="speedLines" min="0" max="200" value="100">
        <div class="range-value" id="speedLinesVal">100%</div>

        <label>Platform Pulse</label>
        <input type="range" id="platformPulse" min="0" max="200" value="100">
        <div class="range-value" id="platformPulseVal">100%</div>

        <label>Impact Waves</label>
        <input type="range" id="impactWaves" min="0" max="200" value="100">
        <div class="range-value" id="impactWavesVal">100%</div>

        <label>Lens Flare</label>
        <input type="range" id="lensFlare" min="0" max="200" value="100">
        <div class="range-value" id="lensFlareVal">100%</div>

        <label>Dynamic Fog</label>
        <input type="range" id="dynamicFog" min="0" max="200" value="100">
        <div class="range-value" id="dynamicFogVal">100%</div>

        <label>Heat Distortion</label>
        <input type="range" id="heatDistortion" min="0" max="200" value="100">
        <div class="range-value" id="heatDistortionVal">100%</div>

        <label>After Images</label>
        <input type="range" id="afterImages" min="0" max="200" value="100">
        <div class="range-value" id="afterImagesVal">100%</div>

        <label>Cosmic Dust Clouds</label>
        <input type="range" id="cosmicDust" min="0" max="200" value="100">
        <div class="range-value" id="cosmicDustVal">100%</div>

        <label>Energy Sphere Pulses</label>
        <input type="range" id="energySphere" min="0" max="200" value="100">
        <div class="range-value" id="energySphereVal">100%</div>

        <label>Geometric Pattern Overlay</label>
        <input type="range" id="geometricPattern" min="0" max="200" value="100">
        <div class="range-value" id="geometricPatternVal">100%</div>

        <label>Color Light Streams</label>
        <input type="range" id="colorLight" min="0" max="200" value="100">
        <div class="range-value" id="colorLightVal">100%</div>

        <label>Spiral Energy Fields</label>
        <input type="range" id="spiralEnergy" min="0" max="200" value="100">
        <div class="range-value" id="spiralEnergyVal">100%</div>

        <label>Metallic Particle Flow</label>
        <input type="range" id="metallicParticle" min="0" max="200" value="100">
        <div class="range-value" id="metallicParticleVal">100%</div>

        <label>Digital Character Rain</label>
        <input type="range" id="digitalCharacter" min="0" max="200" value="100">
        <div class="range-value" id="digitalCharacterVal">100%</div>

        <label>Mystic Floating Orbs</label>
        <input type="range" id="mysticOrb" min="0" max="200" value="100">
        <div class="range-value" id="mysticOrbVal">100%</div>

        <label>Crystal Structure Formation</label>
        <input type="range" id="crystalStructure" min="0" max="200" value="100">
        <div class="range-value" id="crystalStructureVal">100%</div>

        <label>Dark Energy Tendrils</label>
        <input type="range" id="darkEnergy" min="0" max="200" value="100">
        <div class="range-value" id="darkEnergyVal">100%</div>

        <div class="checkbox-container">
          <label>
            <input type="checkbox" id="blockTexture" checked>
            Enable Block Texture
          </label>
        </div>
      </div>

    <!-- Death Effects Settings -->
    <button id="toggleDeath">Death Effects Settings ▼</button>

    <div id="deathSettings">
      <div class="settings-section">
        <div class="section-title">Death Effects</div>

        <label>Die Effects</label>
        <input type="range" id="dieEffect" min="0" max="200" value="100">
        <div class="range-value" id="dieEffectVal">100%</div>

        <label>Shockwave Effects</label>
        <input type="range" id="shockwaves" min="0" max="200" value="100">
        <div class="range-value" id="shockwavesVal">100%</div>

        <label>Screen Distortion</label>
        <input type="range" id="screenDistortion" min="0" max="200" value="100">
        <div class="range-value" id="screenDistortionVal">100%</div>

        <label>Starbursts</label>
        <input type="range" id="starbursts" min="0" max="200" value="100">
        <div class="range-value" id="starburstsVal">100%</div>

        <label>Gravity Waves</label>
        <input type="range" id="gravityWaves" min="0" max="200" value="100">
        <div class="range-value" id="gravityWavesVal">100%</div>

        <label>Energy Ripples</label>
        <input type="range" id="energyRipples" min="0" max="200" value="100">
        <div class="range-value" id="energyRipplesVal">100%</div>

        <label>Pixel Displacement</label>
        <input type="range" id="pixelDisplacement" min="0" max="200" value="100">
        <div class="range-value" id="pixelDisplacementVal">100%</div>
      </div>
    </div>

    <!-- Advanced Effects Settings -->
    <button id="toggleAdvanced">Advanced Effects Settings ▼</button>

    <div id="advancedSettings">
      <div class="settings-section">
        <div class="section-title">Advanced Effects</div>

        <label>Screen Shake Intensity</label>
        <input type="range" id="screenShake" min="0" max="200" value="100">
        <div class="range-value" id="screenShakeVal">100%</div>

        <label>Bloom Particles</label>
        <input type="range" id="bloomParticles" min="0" max="200" value="100">
        <div class="range-value" id="bloomParticlesVal">100%</div>

        <label>Particle Trails</label>
        <input type="range" id="particleTrails" min="0" max="200" value="100">
        <div class="range-value" id="particleTrailsVal">100%</div>

        <label>Particle Count Multiplier</label>
        <input type="range" id="particleCount" min="0" max="200" value="100">
        <div class="range-value" id="particleCountVal">100%</div>

        <label>Trail Length</label>
        <input type="range" id="trailLength" min="0" max="200" value="100">
        <div class="range-value" id="trailLengthVal">100%</div>

        <label>Screen Reflections</label>
        <input type="range" id="screenReflections" min="0" max="200" value="100">
        <div class="range-value" id="screenReflectionsVal">100%</div>

        <label>Motion Blur</label>
        <input type="range" id="motionBlur" min="0" max="200" value="100">
        <div class="range-value" id="motionBlurVal">100%</div>

        <label>Light Rays</label>
        <input type="range" id="lightRays" min="0" max="200" value="100">
        <div class="range-value" id="lightRaysVal">100%</div>

        <label>Color Bleed</label>
        <input type="range" id="colorBleed" min="0" max="200" value="100">
        <div class="range-value" id="colorBleedVal">100%</div>

        <label>Depth of Field</label>
        <input type="range" id="depthOfField" min="0" max="200" value="100">
        <div class="range-value" id="depthOfFieldVal">100%</div>

        <label>Time Dilation</label>
        <input type="range" id="timeDilation" min="0" max="200" value="100">
        <div class="range-value" id="timeDilationVal">100%</div>

        <label>Screen Tear</label>
        <input type="range" id="screenTear" min="0" max="200" value="100">
        <div class="range-value" id="screenTearVal">100%</div>

        <label>Ambient Occlusion</label>
        <input type="range" id="ambientOcclusion" min="0" max="200" value="100">
        <div class="range-value" id="ambientOcclusionVal">100%</div>

        <label>Radial Blur</label>
        <input type="range" id="radialBlur" min="0" max="200" value="100">
        <div class="range-value" id="radialBlurVal">100%</div>
      </div>
          <div class="settings-section">
            <div class="section-title">Visual Enhancement Effects</div>
            
            <label>Platform Pulse</label>
            <input type="range" id="platformPulse" min="0" max="200" value="100">
            <div class="range-value" id="platformPulseVal">100%</div>

            <label>Impact Waves</label>
            <input type="range" id="impactWaves" min="0" max="200" value="100">
            <div class="range-value" id="impactWavesVal">100%</div>

            <label>Color Bleed</label>
            <input type="range" id="colorBleed" min="0" max="200" value="100">
            <div class="range-value" id="colorBleedVal">100%</div>

            <label>Depth of Field</label>
            <input type="range" id="depthOfField" min="0" max="200" value="100">
            <div class="range-value" id="depthOfFieldVal">100%</div>

            <label>Time Dilation</label>
            <input type="range" id="timeDilation" min="0" max="200" value="100">
            <div class="range-value" id="timeDilationVal">100%</div>

            <label>Lens Flare</label>
            <input type="range" id="lensFlare" min="0" max="200" value="100">
            <div class="range-value" id="lensFlareVal">100%</div>

            <label>Screen Tear</label>
            <input type="range" id="screenTear" min="0" max="200" value="100">
            <div class="range-value" id="screenTearVal">100%</div>

            <label>Dynamic Fog</label>
            <input type="range" id="dynamicFog" min="0" max="200" value="100">
            <div class="range-value" id="dynamicFogVal">100%</div>

            <label>Heat Distortion</label>
            <input type="range" id="heatDistortion" min="0" max="200" value="100">
            <div class="range-value" id="heatDistortionVal">100%</div>

            <label>Starbursts</label>
            <input type="range" id="starbursts" min="0" max="200" value="100">
            <div class="range-value" id="starburstsVal">100%</div>

            <label>After Images</label>
            <input type="range" id="afterImages" min="0" max="200" value="100">
            <div class="range-value" id="afterImagesVal">100%</div>

            <label>Gravity Waves</label>
            <input type="range" id="gravityWaves" min="0" max="200" value="100">
            <div class="range-value" id="gravityWavesVal">100%</div>

            <label>Energy Ripples</label>
            <input type="range" id="energyRipples" min="0" max="200" value="100">
            <div class="range-value" id="energyRipplesVal">100%</div>

            <label>Pixel Displacement</label>
            <input type="range" id="pixelDisplacement" min="0" max="200" value="100">
            <div class="range-value" id="pixelDisplacementVal">100%</div>

            <label>Ambient Occlusion</label>
            <input type="range" id="ambientOcclusion" min="0" max="200" value="100">
            <div class="range-value" id="ambientOcclusionVal">100%</div>

            <label>Electric Arcs</label>
            <input type="range" id="electricArcs" min="0" max="200" value="100">
            <div class="range-value" id="electricArcsVal">100%</div>

            <label>Glitch Effects</label>
            <input type="range" id="glitchEffects" min="0" max="200" value="100">
            <div class="range-value" id="glitchEffectsVal">100%</div>

            <label>Rainbow Trails</label>
            <input type="range" id="rainbowTrails" min="0" max="200" value="100">
            <div class="range-value" id="rainbowTrailsVal">100%</div>

            <label>Bubble Effects</label>
            <input type="range" id="bubbleEffects" min="0" max="200" value="100">
            <div class="range-value" id="bubbleEffectsVal">100%</div>

            <label>Crystal Shards</label>
            <input type="range" id="crystalShards" min="0" max="200" value="100">
            <div class="range-value" id="crystalShardsVal">100%</div>

            <label>Fire Particles</label>
            <input type="range" id="fireParticles" min="0" max="200" value="100">
            <div class="range-value" id="fireParticlesVal">100%</div>

            <label>Magnetic Fields</label>
            <input type="range" id="magneticFields" min="0" max="200" value="100">
            <div class="range-value" id="magneticFieldsVal">100%</div>

            <label>Hologram Projections</label>
            <input type="range" id="hologramProjections" min="0" max="200" value="100">
            <div class="range-value" id="hologramProjectionsVal">100%</div>

            <label>Quantum Particles</label>
            <input type="range" id="quantumParticles" min="0" max="200" value="100">
            <div class="range-value" id="quantumParticlesVal">100%</div>

            <label>Sonic Waves</label>
            <input type="range" id="sonicWaves" min="0" max="200" value="100">
            <div class="range-value" id="sonicWavesVal">100%</div>

            <div class="checkbox-container">
              <label>
                <input type="checkbox" id="blockTexture" checked>
                Enable Block Texture
              </label>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div style="margin-top:20px;">
      <button id="cancelBtn">CANCEL</button>
      <button id="saveBtn">SAVE</button>
    </div>
  </div>

  <script>
    // Load settings from localStorage with the correct key
    function loadSettings() {
      try {
        const saved = localStorage.getItem("briddSettings");
        if (!saved) return;
        
        const settings = JSON.parse(saved);
        
        // Set FPS
        document.getElementById("fps").value = settings.maxFPS || 0;
        
        // Set quality preset
        document.getElementById("quality").value = settings.qualityPreset || "Extreme+";
        
        // Set basic effects if they exist
        if (settings.quality) {
          // Block texture is now a checkbox - convert numeric to boolean
          // In game.js: 0 = off, 1 or more = on
          const blockTextureValue = settings.quality.blockTexture || 100;
          document.getElementById("blockTexture").checked = blockTextureValue >= 1;
          
          document.getElementById("jumpEffect").value = settings.quality.jumpEffect || 100;
          document.getElementById("walkEffect").value = settings.quality.walkEffect || 100;
          document.getElementById("dieEffect").value = settings.quality.dieEffect || 100;
          document.getElementById("horizontalLines").value = settings.quality.horizontalLines || 100;
          document.getElementById("trail").value = settings.quality.trail || 100;
          document.getElementById("glow").value = settings.quality.glow || 100;
        }
        
        // Visual Effects
        if (settings.advanced) {
          document.getElementById("parallaxLayers").value = settings.advanced.parallaxLayers || 100;
          document.getElementById("velocityStreaks").value = settings.advanced.velocityStreaks || 100;
          document.getElementById("windParticles").value = settings.advanced.windParticles || 100;
          document.getElementById("speedLines").value = settings.advanced.speedLines || 100;
          document.getElementById("platformPulse").value = settings.advanced.platformPulse || 100;
          document.getElementById("impactWaves").value = settings.advanced.impactWaves || 100;
          document.getElementById("lensFlare").value = settings.advanced.lensFlare || 100;
          document.getElementById("dynamicFog").value = settings.advanced.dynamicFog || 100;
          document.getElementById("heatDistortion").value = settings.advanced.heatDistortion || 100;
          document.getElementById("afterImages").value = settings.advanced.afterImages || 100;
          document.getElementById("cosmicDust").value = settings.advanced.cosmicDust || 100;
          document.getElementById("energySphere").value = settings.advanced.energySphere || 100;
          document.getElementById("geometricPattern").value = settings.advanced.geometricPattern || 100;
          document.getElementById("colorLight").value = settings.advanced.colorLight || 100;
          document.getElementById("spiralEnergy").value = settings.advanced.spiralEnergy || 100;
          document.getElementById("metallicParticle").value = settings.advanced.metallicParticle || 100;
          document.getElementById("digitalCharacter").value = settings.advanced.digitalCharacter || 100;
          document.getElementById("mysticOrb").value = settings.advanced.mysticOrb || 100;
          document.getElementById("crystalStructure").value = settings.advanced.crystalStructure || 100;
          document.getElementById("darkEnergy").value = settings.advanced.darkEnergy || 100;
        }

        // Death Effects
        if (settings.advanced) {
          document.getElementById("shockwaves").value = settings.advanced.shockwaves || 100;
          document.getElementById("screenDistortion").value = settings.advanced.screenDistortion || 100;
          document.getElementById("starbursts").value = settings.advanced.starbursts || 100;
          document.getElementById("gravityWaves").value = settings.advanced.gravityWaves || 100;
          document.getElementById("energyRipples").value = settings.advanced.energyRipples || 100;
          document.getElementById("pixelDisplacement").value = settings.advanced.pixelDisplacement || 100;
        }

        // Advanced Effects
        if (settings.advanced) {
          document.getElementById("screenShake").value = settings.advanced.screenShake || 100;
          document.getElementById("bloomParticles").value = settings.advanced.bloomParticles || 100;
          document.getElementById("particleTrails").value = settings.advanced.particleTrails || 100;
          document.getElementById("particleCount").value = settings.advanced.particleCount || 100;
          document.getElementById("trailLength").value = settings.advanced.trailLength || 100;
          document.getElementById("screenReflections").value = settings.advanced.screenReflections || 100;
          document.getElementById("motionBlur").value = settings.advanced.motionBlur || 100;
          document.getElementById("lightRays").value = settings.advanced.lightRays || 100;
          document.getElementById("colorBleed").value = settings.advanced.colorBleed || 100;
          document.getElementById("depthOfField").value = settings.advanced.depthOfField || 100;
          document.getElementById("timeDilation").value = settings.advanced.timeDilation || 100;
          document.getElementById("screenTear").value = settings.advanced.screenTear || 100;
          document.getElementById("ambientOcclusion").value = settings.advanced.ambientOcclusion || 100;
          document.getElementById("radialBlur").value = settings.advanced.radialBlur || 100;
        }
        
        // Update all range value displays
        updateAllRangeValues();
        
      } catch (e) {
        console.error("Failed to load settings:", e);
      }
    }

    // Update all range value displays
    function updateAllRangeValues() {
      const rangeIds = [
        // Basic effects
        "jumpEffect", "walkEffect", "dieEffect", "horizontalLines", 
        "trail", "glow",
        
        // Original advanced
        "shockwaves", "screenShake", "bloomParticles", "particleTrails", 
        "screenDistortion", "particleCount", "trailLength", "screenReflections",
        "motionBlur", "lightRays",
        
        // Forward motion effects
        "parallaxLayers", "velocityStreaks", "windParticles", "speedLines",
        "radialBlur",
        
        // Visual enhancement effects
        "platformPulse", "impactWaves", "colorBleed", "depthOfField",
        "timeDilation", "lensFlare", "screenTear", "dynamicFog",
        "heatDistortion", "starbursts", "afterImages", "gravityWaves",
        "energyRipples", "pixelDisplacement", "ambientOcclusion",
        "electricArcs", "glitchEffects", "rainbowTrails", "bubbleEffects",
        "crystalShards", "fireParticles", "magneticFields", "hologramProjections",
        "quantumParticles", "sonicWaves"
      ];
      
      rangeIds.forEach(id => {
        updateRangeValue(id);
      });
    }

    // Update range value display
    function updateRangeValue(id) {
      const input = document.getElementById(id);
      const display = document.getElementById(id + "Val");
      if (input && display) {
        display.textContent = input.value + "%";
      }
    }

    // Quality presets mapping (updated with all 20+ effects)
    const qualityPresets = {
      "Potato": {
        quality: {
          blockTexture: false, jumpEffect: 0, walkEffect: 0, dieEffect: 0, 
          horizontalLines: 0, trail: 0, glow: 0
        },
        advanced: {
          shockwaves: 0, screenShake: 0, bloomParticles: 0, 
          particleTrails: 0, screenDistortion: 0,
          particleCount: 10, trailLength: 10, screenReflections: 0,
          motionBlur: 0, lightRays: 0, parallaxLayers: 0,
          velocityStreaks: 0, windParticles: 0, speedLines: 0,
          radialBlur: 0, platformPulse: 0, impactWaves: 0,
          colorBleed: 0, depthOfField: 0, timeDilation: 0,
          lensFlare: 0, screenTear: 0, dynamicFog: 0,
          heatDistortion: 0, starbursts: 0, afterImages: 0,
          gravityWaves: 0, energyRipples: 0, pixelDisplacement: 0,
          ambientOcclusion: 0
        }
      },
      "Low": {
        quality: {
          blockTexture: false, jumpEffect: 5, walkEffect: 0, dieEffect: 0, 
          horizontalLines: 0, trail: 0, glow: 0
        },
        advanced: {
          shockwaves: 0, screenShake: 0, bloomParticles: 0, 
          particleTrails: 0, screenDistortion: 0,
          particleCount: 25, trailLength: 25, screenReflections: 0,
          motionBlur: 0, lightRays: 0, parallaxLayers: 10,
          velocityStreaks: 0, windParticles: 10, speedLines: 10,
          radialBlur: 0, platformPulse: 0, impactWaves: 0,
          colorBleed: 0, depthOfField: 0, timeDilation: 0,
          lensFlare: 0, screenTear: 0, dynamicFog: 0,
          heatDistortion: 0, starbursts: 0, afterImages: 0,
          gravityWaves: 0, energyRipples: 0, pixelDisplacement: 0,
          ambientOcclusion: 0
        }
      },
      "Medium": {
        quality: {
          blockTexture: true, jumpEffect: 10, walkEffect: 0, dieEffect: 10, 
          horizontalLines: 0, trail: 0, glow: 0
        },
        advanced: {
          shockwaves: 0, screenShake: 0, bloomParticles: 0, 
          particleTrails: 0, screenDistortion: 0,
          particleCount: 50, trailLength: 50, screenReflections: 10,
          motionBlur: 0, lightRays: 0, parallaxLayers: 25,
          velocityStreaks: 10, windParticles: 25, speedLines: 25,
          radialBlur: 0, platformPulse: 10, impactWaves: 10,
          colorBleed: 0, depthOfField: 10, timeDilation: 0,
          lensFlare: 0, screenTear: 0, dynamicFog: 0,
          heatDistortion: 0, starbursts: 0, afterImages: 0,
          gravityWaves: 0, energyRipples: 0, pixelDisplacement: 0,
          ambientOcclusion: 0
        }
      },
      "Medium+": {
        quality: {
          blockTexture: true, jumpEffect: 15, walkEffect: 15, dieEffect: 15, 
          horizontalLines: 0, trail: 0, glow: 0
        },
        advanced: {
          shockwaves: 0, screenShake: 0, bloomParticles: 0, 
          particleTrails: 0, screenDistortion: 0,
          particleCount: 75, trailLength: 75, screenReflections: 25,
          motionBlur: 10, lightRays: 10, parallaxLayers: 50,
          velocityStreaks: 25, windParticles: 50, speedLines: 50,
          radialBlur: 10, platformPulse: 25, impactWaves: 25,
          colorBleed: 10, depthOfField: 25, timeDilation: 10,
          lensFlare: 10, screenTear: 0, dynamicFog: 10,
          heatDistortion: 10, starbursts: 10, afterImages: 10,
          gravityWaves: 0, energyRipples: 0, pixelDisplacement: 0,
          ambientOcclusion: 10
        }
      },
      "High": {
        quality: {
          blockTexture: true, jumpEffect: 15, walkEffect: 15, dieEffect: 15, 
          horizontalLines: 15, trail: 0, glow: 0
        },
        advanced: {
          shockwaves: 10, screenShake: 10, bloomParticles: 0, 
          particleTrails: 0, screenDistortion: 0,
          particleCount: 100, trailLength: 100, screenReflections: 50,
          motionBlur: 25, lightRays: 25, parallaxLayers: 75,
          velocityStreaks: 50, windParticles: 75, speedLines: 75,
          radialBlur: 25, platformPulse: 50, impactWaves: 50,
          colorBleed: 25, depthOfField: 50, timeDilation: 25,
          lensFlare: 25, screenTear: 10, dynamicFog: 25,
          heatDistortion: 25, starbursts: 25, afterImages: 25,
          gravityWaves: 10, energyRipples: 10, pixelDisplacement: 10,
          ambientOcclusion: 25
        }
      },
      "High+": {
        quality: {
          blockTexture: true, jumpEffect: 33, walkEffect: 33, dieEffect: 33, 
          horizontalLines: 33, trail: 0, glow: 0
        },
        advanced: {
          shockwaves: 25, screenShake: 25, bloomParticles: 10, 
          particleTrails: 10, screenDistortion: 0,
          particleCount: 125, trailLength: 125, screenReflections: 75,
          motionBlur: 50, lightRays: 50, parallaxLayers: 100,
          velocityStreaks: 75, windParticles: 100, speedLines: 100,
          radialBlur: 50, platformPulse: 75, impactWaves: 75,
          colorBleed: 50, depthOfField: 75, timeDilation: 50,
          lensFlare: 50, screenTear: 25, dynamicFog: 50,
          heatDistortion: 50, starbursts: 50, afterImages: 50,
          gravityWaves: 25, energyRipples: 25, pixelDisplacement: 25,
          ambientOcclusion: 50
        }
      },
      "Extreme": {
        quality: {
          blockTexture: true, jumpEffect: 60, walkEffect: 60, dieEffect: 60, 
          horizontalLines: 60, trail: 0, glow: 0
        },
        advanced: {
          shockwaves: 50, screenShake: 50, bloomParticles: 25, 
          particleTrails: 25, screenDistortion: 10,
          particleCount: 150, trailLength: 150, screenReflections: 100,
          motionBlur: 75, lightRays: 75, parallaxLayers: 125,
          velocityStreaks: 100, windParticles: 125, speedLines: 125,
          radialBlur: 75, platformPulse: 100, impactWaves: 100,
          colorBleed: 75, depthOfField: 100, timeDilation: 75,
          lensFlare: 75, screenTear: 50, dynamicFog: 75,
          heatDistortion: 75, starbursts: 75, afterImages: 75,
          gravityWaves: 50, energyRipples: 50, pixelDisplacement: 50,
          ambientOcclusion: 75
        }
      },
      "Extreme+": {
        quality: {
          blockTexture: true, jumpEffect: 64, walkEffect: 64, dieEffect: 64, 
          horizontalLines: 64, trail: 100, glow: 100
        },
        advanced: {
          shockwaves: 75, screenShake: 75, bloomParticles: 50, 
          particleTrails: 50, screenDistortion: 25,
          particleCount: 175, trailLength: 175, screenReflections: 125,
          motionBlur: 100, lightRays: 100, parallaxLayers: 150,
          velocityStreaks: 125, windParticles: 150, speedLines: 150,
          radialBlur: 100, platformPulse: 125, impactWaves: 125,
          colorBleed: 100, depthOfField: 125, timeDilation: 100,
          lensFlare: 100, screenTear: 75, dynamicFog: 100,
          heatDistortion: 100, starbursts: 100, afterImages: 100,
          gravityWaves: 75, energyRipples: 75, pixelDisplacement: 75,
          ambientOcclusion: 100
        }
      },
      "Ultra": {
        quality: {
          blockTexture: true, jumpEffect: 100, walkEffect: 100, dieEffect: 100, 
          horizontalLines: 100, trail: 0, glow: 100
        },
        advanced: {
          shockwaves: 100, screenShake: 100, bloomParticles: 75, 
          particleTrails: 75, screenDistortion: 50,
          particleCount: 200, trailLength: 200, screenReflections: 150,
          motionBlur: 125, lightRays: 125, parallaxLayers: 175,
          velocityStreaks: 150, windParticles: 175, speedLines: 175,
          radialBlur: 125, platformPulse: 150, impactWaves: 150,
          colorBleed: 125, depthOfField: 150, timeDilation: 125,
          lensFlare: 125, screenTear: 100, dynamicFog: 125,
          heatDistortion: 125, starbursts: 125, afterImages: 125,
          gravityWaves: 100, energyRipples: 100, pixelDisplacement: 100,
          ambientOcclusion: 125
        }
      },
      "Ultra+": {
        quality: {
          blockTexture: true, jumpEffect: 120, walkEffect: 120, dieEffect: 120, 
          horizontalLines: 120, trail: 100, glow: 100
        },
        advanced: {
          shockwaves: 120, screenShake: 120, bloomParticles: 100, 
          particleTrails: 100, screenDistortion: 75,
          particleCount: 250, trailLength: 250, screenReflections: 175,
          motionBlur: 150, lightRays: 150, parallaxLayers: 200,
          velocityStreaks: 175, windParticles: 200, speedLines: 200,
          radialBlur: 150, platformPulse: 175, impactWaves: 175,
          colorBleed: 150, depthOfField: 175, timeDilation: 150,
          lensFlare: 150, screenTear: 125, dynamicFog: 150,
          heatDistortion: 150, starbursts: 150, afterImages: 150,
          gravityWaves: 125, energyRipples: 125, pixelDisplacement: 125,
          ambientOcclusion: 150
        }
      },
      "Ultra++": {
        quality: {
          blockTexture: true, jumpEffect: 200, walkEffect: 200, dieEffect: 200, 
          horizontalLines: 200, trail: 100, glow: 150
        },
        advanced: {
          shockwaves: 150, screenShake: 150, bloomParticles: 150, 
          particleTrails: 150, screenDistortion: 100,
          particleCount: 300, trailLength: 300, screenReflections: 200,
          motionBlur: 175, lightRays: 175, parallaxLayers: 225,
          velocityStreaks: 200, windParticles: 225, speedLines: 225,
          radialBlur: 175, platformPulse: 200, impactWaves: 200,
          colorBleed: 175, depthOfField: 200, timeDilation: 175,
          lensFlare: 175, screenTear: 150, dynamicFog: 175,
          heatDistortion: 175, starbursts: 175, afterImages: 175,
          gravityWaves: 150, energyRipples: 150, pixelDisplacement: 150,
          ambientOcclusion: 175
        }
      },
      "Highest": {
        quality: {
          blockTexture: true, jumpEffect: 200, walkEffect: 200, dieEffect: 200, 
          horizontalLines: 200, trail: 100, glow: 200
        },
        advanced: {
          // Visual Effects
          parallaxLayers: 200, velocityStreaks: 200, windParticles: 200, speedLines: 200,
          platformPulse: 200, impactWaves: 200, lensFlare: 200, dynamicFog: 200,
          heatDistortion: 200, afterImages: 200, cosmicDust: 200, energySphere: 200,
          geometricPattern: 200, colorLight: 200, spiralEnergy: 200, metallicParticle: 200,
          digitalCharacter: 200, mysticOrb: 200, crystalStructure: 200, darkEnergy: 200,

          // Death Effects
          shockwaves: 200, screenDistortion: 200, starbursts: 200, gravityWaves: 200,
          energyRipples: 200, pixelDisplacement: 200,

          // Advanced Effects
          screenShake: 200, bloomParticles: 200, particleTrails: 200, particleCount: 200,
          trailLength: 200, screenReflections: 200, motionBlur: 200, lightRays: 200,
          colorBleed: 200, depthOfField: 200, timeDilation: 200, screenTear: 200,
          ambientOcclusion: 200, radialBlur: 200
        }
      }
    };

    // Setup event listeners for range inputs
    const allRangeIds = [
      // Basic effects
      "jumpEffect", "walkEffect", "dieEffect", "horizontalLines",
      "trail", "glow",

      // Visual Effects
      "parallaxLayers", "velocityStreaks", "windParticles", "speedLines",
      "platformPulse", "impactWaves", "lensFlare", "dynamicFog",
      "heatDistortion", "afterImages", "cosmicDust", "energySphere",
      "geometricPattern", "colorLight", "spiralEnergy", "metallicParticle",
      "digitalCharacter", "mysticOrb", "crystalStructure", "darkEnergy",

      // Death Effects
      "shockwaves", "screenDistortion", "starbursts", "gravityWaves",
      "energyRipples", "pixelDisplacement",

      // Advanced Effects
      "screenShake", "bloomParticles", "particleTrails", "particleCount",
      "trailLength", "screenReflections", "motionBlur", "lightRays",
      "colorBleed", "depthOfField", "timeDilation", "screenTear",
      "ambientOcclusion", "radialBlur"
    ];

    allRangeIds.forEach(id => {
      const input = document.getElementById(id);
      if (input) {
        input.addEventListener("input", () => updateRangeValue(id));
        // When manually adjusting sliders, switch to custom mode
        input.addEventListener("change", () => {
          document.getElementById("quality").value = "Custom";
        });
        // Also switch to custom when user starts dragging (mousedown)
        input.addEventListener("mousedown", () => {
          document.getElementById("quality").value = "Custom";
        });
        // For touch devices
        input.addEventListener("touchstart", () => {
          document.getElementById("quality").value = "Custom";
        });
      }
    });

    // When block texture checkbox changes, switch to custom mode
    document.getElementById("blockTexture").addEventListener("change", () => {
      document.getElementById("quality").value = "Custom";
    });

    // When FPS dropdown changes, switch to custom mode
    document.getElementById("fps").addEventListener("change", () => {
      document.getElementById("quality").value = "Custom";
    });

    // Toggle visual effects settings
    document.getElementById("toggleEffects").addEventListener("click", function() {
      const effects = document.getElementById("effectsSettings");
      if (effects.style.display === "none" || effects.style.display === "") {
        effects.style.display = "block";
        this.textContent = "Visual Effects Settings ▲";
      } else {
        effects.style.display = "none";
        this.textContent = "Visual Effects Settings ▼";
      }
    });

    // Toggle advanced settings
    document.getElementById("toggleAdvanced").addEventListener("click", function() {
      const adv = document.getElementById("advancedSettings");
      if (adv.style.display === "none" || adv.style.display === "") {
        adv.style.display = "block";
        this.textContent = "Advanced Effects Settings ▲";
      } else {
        adv.style.display = "none";
        this.textContent = "Advanced Effects Settings ▼";
      }
    });
    
    // Toggle motion effects
    document.getElementById("toggleMotion").addEventListener("click", function() {
      const motion = document.getElementById("motionEffects");
      if (motion.style.display === "none" || motion.style.display === "") {
        motion.style.display = "block";
        this.textContent = "Forward Motion Effects ▲";
      } else {
        motion.style.display = "none";
        this.textContent = "Forward Motion Effects ▼";
      }
    });
    
    // Toggle visual enhancement effects
    document.getElementById("toggleVisual").addEventListener("click", function() {
      const visual = document.getElementById("visualEnhancement");
      if (visual.style.display === "none" || visual.style.display === "") {
        visual.style.display = "block";
        this.textContent = "Visual Enhancement Effects ▲";
      } else {
        visual.style.display = "none";
        this.textContent = "Visual Enhancement Effects ▼";
      }
    });

    // When quality preset changes, update sliders
    document.getElementById("quality").addEventListener("change", function() {
      const preset = qualityPresets[this.value];
      if (preset) {
        // Update basic effects
        if (preset.quality) {
          for (const [key, value] of Object.entries(preset.quality)) {
            const input = document.getElementById(key);
            if (input) {
              if (key === "blockTexture") {
                // Special handling for checkbox
                input.checked = Boolean(value);
              } else {
                input.value = value;
                updateRangeValue(key);
              }
            }
          }
        }
        
        // Update advanced effects
        if (preset.advanced) {
          for (const [key, value] of Object.entries(preset.advanced)) {
            const input = document.getElementById(key);
            if (input) {
              input.value = value;
              updateRangeValue(key);
            }
          }
        }
        
        // Auto-expand sections for high presets
        if (["Ultra", "Ultra+", "Ultra++", "Highest"].includes(this.value)) {
          const adv = document.getElementById("advancedSettings");
          const advToggle = document.getElementById("toggleAdvanced");
          adv.style.display = "block";
          advToggle.textContent = "Advanced Effects Settings ▲";
        }
      }
    });

    // Save settings and go back to game
    document.getElementById("saveBtn").addEventListener("click", function() {
      const settings = {
        maxFPS: parseInt(document.getElementById("fps").value) || 0,
        qualityPreset: document.getElementById("quality").value === "Custom" ? "Extreme+" : document.getElementById("quality").value,
        quality: {
          blockTexture: document.getElementById("blockTexture").checked ? 100 : 0,
          jumpEffect: parseInt(document.getElementById("jumpEffect").value) || 0,
          walkEffect: parseInt(document.getElementById("walkEffect").value) || 0,
          dieEffect: parseInt(document.getElementById("dieEffect").value) || 0,
          horizontalLines: parseInt(document.getElementById("horizontalLines").value) || 0,
          trail: parseInt(document.getElementById("trail").value) || 0,
          glow: parseInt(document.getElementById("glow").value) || 0
        },
        advanced: {
          // Original advanced effects
          shockwaves: parseInt(document.getElementById("shockwaves").value) || 0,
          screenShake: parseInt(document.getElementById("screenShake").value) || 0,
          bloomParticles: parseInt(document.getElementById("bloomParticles").value) || 0,
          particleTrails: parseInt(document.getElementById("particleTrails").value) || 0,
          screenDistortion: parseInt(document.getElementById("screenDistortion").value) || 0,
          
          // Visual Effects
          parallaxLayers: parseInt(document.getElementById("parallaxLayers").value) || 0,
          velocityStreaks: parseInt(document.getElementById("velocityStreaks").value) || 0,
          windParticles: parseInt(document.getElementById("windParticles").value) || 0,
          speedLines: parseInt(document.getElementById("speedLines").value) || 0,
          platformPulse: parseInt(document.getElementById("platformPulse").value) || 0,
          impactWaves: parseInt(document.getElementById("impactWaves").value) || 0,
          lensFlare: parseInt(document.getElementById("lensFlare").value) || 0,
          dynamicFog: parseInt(document.getElementById("dynamicFog").value) || 0,
          heatDistortion: parseInt(document.getElementById("heatDistortion").value) || 0,
          afterImages: parseInt(document.getElementById("afterImages").value) || 0,
          cosmicDust: parseInt(document.getElementById("cosmicDust").value) || 0,
          energySphere: parseInt(document.getElementById("energySphere").value) || 0,
          geometricPattern: parseInt(document.getElementById("geometricPattern").value) || 0,
          colorLight: parseInt(document.getElementById("colorLight").value) || 0,
          spiralEnergy: parseInt(document.getElementById("spiralEnergy").value) || 0,
          metallicParticle: parseInt(document.getElementById("metallicParticle").value) || 0,
          digitalCharacter: parseInt(document.getElementById("digitalCharacter").value) || 0,
          mysticOrb: parseInt(document.getElementById("mysticOrb").value) || 0,
          crystalStructure: parseInt(document.getElementById("crystalStructure").value) || 0,
          darkEnergy: parseInt(document.getElementById("darkEnergy").value) || 0,

          // Death Effects
          shockwaves: parseInt(document.getElementById("shockwaves").value) || 0,
          screenDistortion: parseInt(document.getElementById("screenDistortion").value) || 0,
          starbursts: parseInt(document.getElementById("starbursts").value) || 0,
          gravityWaves: parseInt(document.getElementById("gravityWaves").value) || 0,
          energyRipples: parseInt(document.getElementById("energyRipples").value) || 0,
          pixelDisplacement: parseInt(document.getElementById("pixelDisplacement").value) || 0,

          // Advanced Effects
          screenShake: parseInt(document.getElementById("screenShake").value) || 0,
          bloomParticles: parseInt(document.getElementById("bloomParticles").value) || 0,
          particleTrails: parseInt(document.getElementById("particleTrails").value) || 0,
          particleCount: parseInt(document.getElementById("particleCount").value) || 0,
          trailLength: parseInt(document.getElementById("trailLength").value) || 0,
          screenReflections: parseInt(document.getElementById("screenReflections").value) || 0,
          motionBlur: parseInt(document.getElementById("motionBlur").value) || 0,
          lightRays: parseInt(document.getElementById("lightRays").value) || 0,
          colorBleed: parseInt(document.getElementById("colorBleed").value) || 0,
          depthOfField: parseInt(document.getElementById("depthOfField").value) || 0,
          timeDilation: parseInt(document.getElementById("timeDilation").value) || 0,
          screenTear: parseInt(document.getElementById("screenTear").value) || 0,
          ambientOcclusion: parseInt(document.getElementById("ambientOcclusion").value) || 0,
          radialBlur: parseInt(document.getElementById("radialBlur").value) || 0
        }
      };
      
      try {
        localStorage.setItem("briddSettings", JSON.stringify(settings));
        // Go back to the game
        window.location.href = "index.html";
      } catch (e) {
        console.error("Failed to save settings:", e);
        alert("Failed to save settings!");
      }
    });

    // Cancel button - just go back without saving
    document.getElementById("cancelBtn").addEventListener("click", function() {
      window.location.href = "index.html";
    });

    // Toggle handlers for collapsible sections
    document.getElementById("toggleVisual").addEventListener("click", function() {
      const section = document.getElementById("visualSettings");
      if (section.style.display === "none" || section.style.display === "") {
        section.style.display = "block";
        this.textContent = "Visual Effects Settings ▲";
      } else {
        section.style.display = "none";
        this.textContent = "Visual Effects Settings ▼";
      }
    });

    document.getElementById("toggleDeath").addEventListener("click", function() {
      const section = document.getElementById("deathSettings");
      if (section.style.display === "none" || section.style.display === "") {
        section.style.display = "block";
        this.textContent = "Death Effects Settings ▲";
      } else {
        section.style.display = "none";
        this.textContent = "Death Effects Settings ▼";
      }
    });

    document.getElementById("toggleAdvanced").addEventListener("click", function() {
      const section = document.getElementById("advancedSettings");
      if (section.style.display === "none" || section.style.display === "") {
        section.style.display = "block";
        this.textContent = "Advanced Effects Settings ▲";
      } else {
        section.style.display = "none";
        this.textContent = "Advanced Effects Settings ▼";
      }
    });

    // Load settings on page load
    window.addEventListener("load", function() {
      loadSettings();
      
      // Show visual effects settings by default if any advanced setting is > 0
      const saved = localStorage.getItem("briddSettings");
      if (saved) {
        try {
          const settings = JSON.parse(saved);
          let hasEffects = false;
          
          // Check basic effects
          if (settings.quality) {
            const basicEffects = Object.values(settings.quality);
            hasEffects = basicEffects.some(val => val > 0);
          }
          
          // Check advanced effects
          if (settings.advanced) {
            const advancedEffects = Object.values(settings.advanced);
            hasEffects = hasEffects || advancedEffects.some(val => val > 0);
          }
          
          if (hasEffects) {
            const toggle = document.getElementById("toggleVisual");
            const effects = document.getElementById("visualSettings");
            effects.style.display = "block";
            toggle.textContent = "Visual Effects Settings ▲";
          }
          
          // Auto-expand advanced for high presets
          const preset = settings.qualityPreset;
          if (["Ultra", "Ultra+", "Ultra++", "Highest"].includes(preset)) {
            const adv = document.getElementById("advancedSettings");
            const advToggle = document.getElementById("toggleAdvanced");
            adv.style.display = "block";
            advToggle.textContent = "Advanced Effects Settings ▲";
          }
        } catch (e) {
          console.error("Error checking settings:", e);
        }
      }
    });
  </script>
</body>
</html>