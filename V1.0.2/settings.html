<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Settings | Bridd Jump</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
  <style>
    body { margin: 0; padding: 0; background: black; color: #0ff;
      font-family: 'Press Start 2P', cursive; display: flex;
      justify-content: center; align-items: center; min-height: 100vh; }
    .container { background: rgba(0,0,0,0.9); border: 3px solid #0ff;
      border-radius: 20px; padding: 30px; width: 700px; max-width: 95%;
      text-align: center; }
    h1 { font-size: 24px; margin-bottom: 20px;
      text-shadow: 0 0 10px #0ff, 0 0 20px #0ff; }
    label { display: block; margin: 15px 0 5px; font-size: 12px; }
    select, input[type=range], input[type=checkbox] {
      margin-bottom: 10px; background: black; color: #0ff;
      border: 2px solid #0ff; font-family: 'Press Start 2P', cursive;
      font-size: 12px; padding: 5px; }
    select, input[type=range] { width: 100%; }
    .range-value { font-size: 10px; margin-top: -5px; margin-bottom: 10px; color: #fff; }
    button { margin: 15px; padding: 12px 30px; font-size: 12px; cursor: pointer;
      color: #0ff; background: black; border: 3px solid #0ff; border-radius: 10px;
      font-family: 'Press Start 2P', cursive; transition: 0.3s; }
    button:hover { background: #0ff; color: black; }
    #advancedSettings { display: none; margin-top: 10px; border-top: 1px solid #0ff;
      padding-top: 10px; }
    #toggleAdvanced { font-size: 12px; background: transparent; border: 2px solid #0ff;
      padding: 8px 12px; cursor: pointer; margin-bottom: 10px; }
    #toggleAdvanced:hover { background: #0ff; color: black; }
    .checkbox-container { display: flex; align-items: center; justify-content: center;
      margin: 10px 0; }
    .checkbox-container label { margin: 0; display: flex; align-items: center;
      justify-content: center; gap: 10px; cursor: pointer; font-size: 10px; }
    .checkbox-container input[type="checkbox"] { width: 20px; height: 20px;
      margin: 0; cursor: pointer; }
  </style>
</head>
<body>
  <div class="container">
    <h1>SETTINGS</h1>

    <label for="fps">Max FPS:</label>
    <select id="fps">
      <option value="0">Unlimited</option>
      <option value="30">30</option>
      <option value="60">60</option>
      <option value="120">120</option>
      <option value="144">144</option>
      <option value="240">240</option>
    </select>

    <label for="quality">Quality Preset:</label>
    <select id="quality">
      <option value="Potato">Potato</option>
      <option value="Low">Low</option>
      <option value="Medium">Medium</option>
      <option value="Medium+">Medium+</option>
      <option value="High">High</option>
      <option value="High+">High+</option>
      <option value="Extreme">Extreme</option>
      <option value="Extreme+" selected>Extreme+</option>
      <option value="Ultra">Ultra</option>
      <option value="Ultra+">Ultra+</option>
      <option value="Glow Highest">Glow Highest</option>
      <option value="All Effects">All Effects</option>
    </select>

    <button id="toggleAdvanced">Advanced Settings ▼</button>

    <div id="advancedSettings">
      <label>Jump Effects</label>
      <input type="range" id="jumpEffect" min="0" max="200" value="100">
      <div class="range-value" id="jumpEffectVal">100%</div>

      <label>Walk Effects</label>
      <input type="range" id="walkEffect" min="0" max="200" value="100">
      <div class="range-value" id="walkEffectVal">100%</div>

      <label>Die Effects</label>
      <input type="range" id="dieEffect" min="0" max="200" value="100">
      <div class="range-value" id="dieEffectVal">100%</div>

      <label>Horizontal Line Effects</label>
      <input type="range" id="horizontalLines" min="0" max="200" value="100">
      <div class="range-value" id="horizontalLinesVal">100%</div>

      <label>Trail Effects</label>
      <input type="range" id="trail" min="0" max="200" value="100">
      <div class="range-value" id="trailVal">100%</div>

      <label>Glow Intensity</label>
      <input type="range" id="glow" min="0" max="200" value="100">
      <div class="range-value" id="glowVal">100%</div>

      <!-- NEW EFFECTS -->
      <label>Screen Shake Intensity</label>
      <input type="range" id="screenShake" min="0" max="200" value="100">
      <div class="range-value" id="screenShakeVal">100%</div>

      <label>Particle Physics</label>
      <input type="range" id="particlePhysics" min="0" max="200" value="100">
      <div class="range-value" id="particlePhysicsVal">100%</div>

      <label>Color Intensity</label>
      <input type="range" id="colorIntensity" min="0" max="200" value="100">
      <div class="range-value" id="colorIntensityVal">100%</div>

      <label>Motion Blur</label>
      <input type="range" id="motionBlur" min="0" max="200" value="0">
      <div class="range-value" id="motionBlurVal">0%</div>

      <label>After Images</label>
      <input type="range" id="afterImages" min="0" max="200" value="0">
      <div class="range-value" id="afterImagesVal">0%</div>

      <!-- Block Texture Checkbox (FIXED LOGIC) -->
      <div class="checkbox-container">
        <label>
          <input type="checkbox" id="blockTexture" checked>
          Enable Block Texture
        </label>
      </div>
    </div>

    <div style="margin-top:20px;">
      <button id="cancelBtn">CANCEL</button>
      <button id="saveBtn">SAVE</button>
    </div>
  </div>

  <script>
    // Quality presets with all new effects
    const qualityPresets = {
      "Potato": {
        jumpEffect: 0, walkEffect: 0, dieEffect: 0, horizontalLines: 0,
        trail: 0, glow: 0, screenShake: 0, particlePhysics: 0,
        colorIntensity: 50, motionBlur: 0, afterImages: 0, blockTexture: false
      },
      "Low": {
        jumpEffect: 20, walkEffect: 0, dieEffect: 20, horizontalLines: 0,
        trail: 0, glow: 0, screenShake: 20, particlePhysics: 20,
        colorIntensity: 60, motionBlur: 0, afterImages: 0, blockTexture: false
      },
      "Medium": {
        jumpEffect: 50, walkEffect: 30, dieEffect: 50, horizontalLines: 0,
        trail: 0, glow: 0, screenShake: 40, particlePhysics: 40,
        colorIntensity: 75, motionBlur: 0, afterImages: 0, blockTexture: true
      },
      "Medium+": {
        jumpEffect: 70, walkEffect: 50, dieEffect: 70, horizontalLines: 30,
        trail: 0, glow: 0, screenShake: 60, particlePhysics: 60,
        colorIntensity: 85, motionBlur: 0, afterImages: 0, blockTexture: true
      },
      "High": {
        jumpEffect: 85, walkEffect: 70, dieEffect: 85, horizontalLines: 60,
        trail: 30, glow: 30, screenShake: 75, particlePhysics: 75,
        colorIntensity: 95, motionBlur: 20, afterImages: 0, blockTexture: true
      },
      "High+": {
        jumpEffect: 100, walkEffect: 85, dieEffect: 100, horizontalLines: 80,
        trail: 60, glow: 60, screenShake: 85, particlePhysics: 85,
        colorIntensity: 110, motionBlur: 40, afterImages: 20, blockTexture: true
      },
      "Extreme": {
        jumpEffect: 120, walkEffect: 100, dieEffect: 120, horizontalLines: 100,
        trail: 80, glow: 80, screenShake: 95, particlePhysics: 95,
        colorIntensity: 125, motionBlur: 60, afterImages: 40, blockTexture: true
      },
      "Extreme+": {
        jumpEffect: 140, walkEffect: 120, dieEffect: 140, horizontalLines: 120,
        trail: 100, glow: 100, screenShake: 110, particlePhysics: 110,
        colorIntensity: 140, motionBlur: 80, afterImages: 60, blockTexture: true
      },
      "Ultra": {
        jumpEffect: 160, walkEffect: 140, dieEffect: 160, horizontalLines: 140,
        trail: 120, glow: 120, screenShake: 125, particlePhysics: 125,
        colorIntensity: 155, motionBlur: 100, afterImages: 80, blockTexture: true
      },
      "Ultra+": {
        jumpEffect: 180, walkEffect: 160, dieEffect: 180, horizontalLines: 160,
        trail: 140, glow: 140, screenShake: 140, particlePhysics: 140,
        colorIntensity: 170, motionBlur: 120, afterImages: 100, blockTexture: true
      },
      "Glow Highest": {
        jumpEffect: 200, walkEffect: 180, dieEffect: 200, horizontalLines: 180,
        trail: 160, glow: 150, screenShake: 155, particlePhysics: 155,
        colorIntensity: 185, motionBlur: 140, afterImages: 120, blockTexture: true
      },
      "All Effects": {
        jumpEffect: 200, walkEffect: 200, dieEffect: 200, horizontalLines: 200,
        trail: 200, glow: 200, screenShake: 200, particlePhysics: 200,
        colorIntensity: 200, motionBlur: 200, afterImages: 200, blockTexture: true
      }
    };

    // Load settings
    function loadSettings() {
      try {
        const saved = localStorage.getItem("briddSettings");
        if (!saved) return;
        
        const settings = JSON.parse(saved);
        
        document.getElementById("fps").value = settings.maxFPS || 0;
        document.getElementById("quality").value = settings.qualityPreset || "Extreme+";
        
        if (settings.quality) {
          const ids = ["jumpEffect","walkEffect","dieEffect","horizontalLines","trail","glow",
                      "screenShake","particlePhysics","colorIntensity","motionBlur","afterImages"];
          
          ids.forEach(id => {
            if(settings.quality[id] !== undefined) {
              document.getElementById(id).value = settings.quality[id];
              updateRangeValue(id);
            }
          });
          
          document.getElementById("blockTexture").checked = Boolean(settings.quality.blockTexture);
        }
      } catch(e) { console.error("Failed to load:", e); }
    }

    function updateRangeValue(id) {
      const input = document.getElementById(id);
      const display = document.getElementById(id + "Val");
      if(input && display) display.textContent = input.value + "%";
    }

    // Setup sliders
    ["jumpEffect","walkEffect","dieEffect","horizontalLines","trail","glow",
     "screenShake","particlePhysics","colorIntensity","motionBlur","afterImages"].forEach(id => {
      const input = document.getElementById(id);
      if(input) {
        input.addEventListener("input", () => updateRangeValue(id));
        input.addEventListener("change", () => {
          document.getElementById("quality").value = "Custom";
        });
      }
    });

    // Toggle advanced
    document.getElementById("toggleAdvanced").addEventListener("click", function() {
      const adv = document.getElementById("advancedSettings");
      adv.style.display = adv.style.display === "none" ? "block" : "none";
      this.textContent = adv.style.display === "block" ? 
        "Advanced Settings ▲" : "Advanced Settings ▼";
    });

    // Preset change
    document.getElementById("quality").addEventListener("change", function() {
      const preset = qualityPresets[this.value];
      if(preset) {
        for(const [key, value] of Object.entries(preset)) {
          const input = document.getElementById(key);
          if(input) {
            if(input.type === "checkbox") {
              input.checked = Boolean(value);
            } else {
              input.value = value;
              updateRangeValue(key);
            }
          }
        }
      }
    });

    // Save
    document.getElementById("saveBtn").addEventListener("click", function() {
      const settings = {
        maxFPS: parseInt(document.getElementById("fps").value) || 0,
        qualityPreset: document.getElementById("quality").value,
        quality: {
          jumpEffect: parseInt(document.getElementById("jumpEffect").value) || 0,
          walkEffect: parseInt(document.getElementById("walkEffect").value) || 0,
          dieEffect: parseInt(document.getElementById("dieEffect").value) || 0,
          horizontalLines: parseInt(document.getElementById("horizontalLines").value) || 0,
          trail: parseInt(document.getElementById("trail").value) || 0,
          glow: parseInt(document.getElementById("glow").value) || 0,
          screenShake: parseInt(document.getElementById("screenShake").value) || 0,
          particlePhysics: parseInt(document.getElementById("particlePhysics").value) || 0,
          colorIntensity: parseInt(document.getElementById("colorIntensity").value) || 0,
          motionBlur: parseInt(document.getElementById("motionBlur").value) || 0,
          afterImages: parseInt(document.getElementById("afterImages").value) || 0,
          blockTexture: document.getElementById("blockTexture").checked
        }
      };
      
      try {
        localStorage.setItem("briddSettings", JSON.stringify(settings));
        window.location.href = "index.html";
      } catch(e) {
        console.error("Save failed:", e);
        alert("Failed to save!");
      }
    });

    // Cancel
    document.getElementById("cancelBtn").addEventListener("click", function() {
      window.location.href = "index.html";
    });

    window.addEventListener("load", loadSettings);
  </script>
</body>
</html>